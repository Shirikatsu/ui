{"version":3,"file":"ContextMenu.js","sources":["../../../../../src/components/ContextMenu/ContextMenu.js"],"sourcesContent":["import React, { useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\nimport { Spring, animated } from 'react-spring'\nimport ClickOutHandler from 'react-onclickout'\nimport { useTheme } from '../../theme'\nimport { springs, RADIUS } from '../../style'\nimport { IconEllipsis, IconDown } from '../../icons/components'\nimport ButtonBase from '../ButtonBase/ButtonBase'\n\nconst BASE_WIDTH = 46\nconst BASE_HEIGHT = 32\n\nfunction ContextMenu({ children, zIndex, disabled }) {\n  const theme = useTheme()\n  const [opened, setOpened] = useState(false)\n\n  const handleClose = useCallback(() => {\n    setOpened(false)\n  }, [])\n\n  const handleBaseButtonClick = useCallback(() => {\n    setOpened(opened => !opened)\n  }, [])\n\n  // Increase the z-index on an opened menu, to make sure it's above any other\n  // context menus below it using the same z-index (e.g. when used in a list)\n  const appliedZIndex = opened ? zIndex + 1 : zIndex\n\n  return (\n    <ClickOutHandler onClickOut={handleClose}>\n      <Spring\n        config={springs.smooth}\n        to={{ openProgress: Number(opened) }}\n        native\n      >\n        {({ openProgress }) => (\n          <Main\n            css={`\n              z-index: ${appliedZIndex};\n            `}\n            style={{\n              boxShadow: openProgress.interpolate(\n                t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n              ),\n            }}\n          >\n            <Button\n              onClick={handleBaseButtonClick}\n              opened={opened}\n              disabled={disabled}\n              focusRingRadius={RADIUS}\n              css={`\n                color: ${disabled\n                  ? theme.disabledContent\n                  : opened\n                  ? theme.accent\n                  : theme.surfaceContent};\n                background: ${disabled ? theme.disabled : theme.surface};\n                border: ${disabled ? '0' : `1px solid ${theme.border}`};\n                border-bottom-color: ${opened ? theme.surface : theme.border};\n                ${disabled\n                  ? ''\n                  : `&:active {\n                  background: ${theme.surfacePressed};\n                  border-bottom-color: ${\n                    opened ? theme.surfacePressed : theme.border\n                  };\n                }`}\n              `}\n            >\n              <IconEllipsis css={``} />\n              <animated.div\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  transformOrigin: '50% 50%',\n                  transform: openProgress.interpolate(\n                    v => `rotate(${v * 180}deg)`\n                  ),\n                }}\n              >\n                <IconDown\n                  size=\"tiny\"\n                  css={`\n                    color: ${disabled ? theme.disabledIcon : theme.surfaceIcon};\n                  `}\n                />\n              </animated.div>\n            </Button>\n            {opened && (\n              <React.Fragment>\n                <animated.div\n                  onClick={handleClose}\n                  style={{\n                    opacity: openProgress,\n                    boxShadow: openProgress.interpolate(\n                      t => `0 4px 4px rgba(0, 0, 0, ${t * 0.03})`\n                    ),\n                  }}\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    overflow: hidden;\n                    position: absolute;\n                    top: ${BASE_HEIGHT - 1}px;\n                    right: 0;\n                    background: ${theme.surface};\n                    border: 1px solid ${theme.border};\n                    border-radius: 3px 0 3px 3px;\n                  `}\n                >\n                  {children}\n                </animated.div>\n                <div\n                  css={`\n                    z-index: ${appliedZIndex + 1};\n                    position: absolute;\n                    bottom: 0;\n                    right: 1px;\n                    height: 1px;\n                    width: ${BASE_WIDTH - 2}px;\n                    background: ${theme.surface};\n                  `}\n                />\n              </React.Fragment>\n            )}\n          </Main>\n        )}\n      </Spring>\n    </ClickOutHandler>\n  )\n}\n\nContextMenu.propTypes = {\n  children: PropTypes.node,\n  zIndex: PropTypes.number,\n  disabled: PropTypes.bool,\n}\nContextMenu.defaultProps = {\n  zIndex: 0,\n  disabled: false,\n}\n\nconst Main = styled(animated.div)`\n  position: relative;\n  width: ${BASE_WIDTH}px;\n  height: ${BASE_HEIGHT}px;\n`\n\nconst Button = styled(ButtonBase)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: ${BASE_HEIGHT}px;\n  border-radius: ${({ opened }) =>\n    opened ? `${RADIUS}px ${RADIUS}px 0 0` : `${RADIUS}px`};\n\n  box-shadow: ${({ disabled }) =>\n    disabled ? 'none' : `0px 1px 3px rgba(0, 0, 0, 0.1)`};\n`\n\nexport default ContextMenu\n"],"names":["BASE_WIDTH","BASE_HEIGHT","ContextMenu","children","zIndex","disabled","theme","useTheme","opened","setOpened","useState","handleClose","useCallback","handleBaseButtonClick","appliedZIndex","ClickOutHandler","springs","smooth","openProgress","Number","boxShadow","interpolate","t","RADIUS","disabledContent","accent","surfaceContent","surface","border","surfacePressed","animated","display","alignItems","transformOrigin","transform","v","disabledIcon","surfaceIcon","opacity","propTypes","PropTypes","node","number","bool","defaultProps","Main","styled","div","Button","ButtonBase"],"mappings":"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"}